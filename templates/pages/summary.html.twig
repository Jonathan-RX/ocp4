{% extends 'base.html.twig' %}

{% block title 'Musée du Louvre, Récapitulatif' %}

{% block body %}

    <div class="row bg-white">
        <h3 class="col-sm">Recapitulatif</h3>
    </div>
    <div class="row bg-white">
        <div class="col-sm nopadding">
            <div class="card p-2 pl-3 ticket">
            <h5>Informations de la visite</h5>
                Jour de la visite: {{ commands.getDateVisit|date("d/m/Y") }}<br />
                Période:
                {% if commands.getDuration == true %}
                    Journée
                {% else %}
                    Demi-Journée
                {% endif %}
            </div>
        </div>
    </div>
{% for ticket in tickets %}
<div class="row bg-white">
    <div class="col-sm nopadding">
        <div class="card p-2 pl-3 ticket">
            Nom: {{ ticket.getLastName }}<br />
            Prénom: {{ ticket.getFirstName }}<br />
            Pays: {{ ticket.getCountry }}<br />
            Date de naissance: {{ ticket.getBirthDate|date('d/m/Y') }}<br />
            Tarif réduit:
                {% if ticket.getDiscount == true %}
                    Oui
                {% else %}
                    Non
                {% endif %}<br />
            Prix du billet: {{ ticket.getPrice }} €
        </div>
    </div>
</div>

{% endfor %}

<div class="row bg-white">
    <div class="col-sm nopadding">
        <div class="card p-2 pl-3 ticket">
            <h5>Total de votre commande </h5>
            Hors taxes: {{ pricewt }} €<br />
            TVA: {{ taxes }} €<br />
            <strong>Total: {{ priceati }} €</strong>
            <form action="#" method="POST" id="payment-form">
                <div class="form-row">

                    <div class="col-xl" id="card-element">
                    </div>

                    <div id="card-errors" role="alert"></div>
                </div>
                <input type="hidden" name="command_number" value="{{ commands.getOrderNumber }}">
                <p><button class="ui button" type="submit">Régler</button></p>
            </form>
        </div>
    </div>
</div>

{% endblock %}

{% block javascripts %}
<script type="text/javascript">
    $(document).ready(function() {
        var stripe = Stripe('pk_test_c4l5H82if8OGbq0AHQBuZSa900U00gHkuW');
        stripe.redirectToCheckout({
            sessionId: '{{ session.id }}'
        }).then(function (result) {
            // If `redirectToCheckout` fails due to a browser or network
            // error, display the localized error message to your customer
            // using `result.error.message`.
        });
    });

</script>
{% endblock %}

{% block stylesheets  %}
<style type="text/css">
    #card-element{
        display:block;
        padding:5px;
        border: 1px solid black;
        border-radius: 2px;
        margin: 10px;
    }
    #card-element *{
        display: none;
        border: 1px solid black;
    }
</style>
{% endblock %}